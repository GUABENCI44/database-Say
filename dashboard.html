<!doctype html><html><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Whitelist Panel â€“ Dashboard</title>
<link rel="stylesheet" href="/public/style.css"/>
</head><body>
<div class="container">
  <div class="card">
    <div class="header">
      <div class="title">ðŸ“‹ Whitelist Dashboard</div>
      <div>
        <a class="link" href="#" onclick="logout()">Logout</a>
      </div>
    </div>
    <div class="row">
      <input id="number" class="input" placeholder="Nomor (contoh: 62812xxxx)"/>
      <button class="btn" onclick="addNumber()">Tambah</button>
    </div>
    <table class="table" id="table">
      <thead><tr><th>Nomor</th><th>Aksi</th></tr></thead>
      <tbody></tbody>
    </table>
    <div class="footer">Gunakan format tanpa spasi. SC akan mengecek ke <code>/api/check?number=...</code>.</div>
  </div>
</div>
<script>
function token(){return localStorage.getItem('token')||''}
function logout(){localStorage.removeItem('token');location.href='/'}
async function guard(){
  if(!token()){location.href='/';return}
  await loadList();
}
async function loadList(){
  const res=await fetch('/api/list',{headers:{Authorization:'Bearer '+token()}});
  if(!res.ok){logout();return}
  const data=await res.json();
  const tbody=document.querySelector('#table tbody'); tbody.innerHTML='';
  (data.data||[]).forEach(n=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${n}</td><td><button class="btn" onclick="removeNumber('${n}')">Hapus</button></td>`;
    tbody.appendChild(tr);
  });
}
async function addNumber(){
  const number=document.getElementById('number').value.trim();
  if(!number) return;
  const res=await fetch('/api/add',{method:'POST',headers:{'Content-Type':'application/json',Authorization:'Bearer '+token()},body:JSON.stringify({number})});
  await loadList();
  document.getElementById('number').value='';
}
async function removeNumber(n){
  await fetch('/api/remove',{method:'POST',headers:{'Content-Type':'application/json',Authorization:'Bearer '+token()},body:JSON.stringify({number:n})});
  await loadList();
}
guard();
</script>
</body></html>